<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Diagn√≥stico</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .test-container {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .test-button {
            background: #3b82f6;
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            margin: 10px;
        }
        .test-button:hover {
            background: #2563eb;
        }
        .result {
            margin-top: 20px;
            padding: 20px;
            background: #f8fafc;
            border-radius: 8px;
            border-left: 4px solid #3b82f6;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <h1>üß™ Test del Sistema de Diagn√≥stico</h1>
        <p>Este es un test para verificar que el sistema de diagn√≥stico funciona correctamente.</p>
        
        <button class="test-button" onclick="testDiagnosis()">üîç Probar Diagn√≥stico</button>
        <button class="test-button" onclick="testChart()">üìä Probar Gr√°fica</button>
        <button class="test-button" onclick="clearResults()">üóëÔ∏è Limpiar Resultados</button>
        
        <div id="testResult" class="result" style="display: none;">
            <h3>Resultado del Test:</h3>
            <div id="testContent"></div>
        </div>
    </div>

    <script>
        // Simular respuestas de prueba
        const testAnswers = {
            q1: 'urbana',
            q2: ['falta_empleo', 'salud', 'ambientales'],
            q3: 'mucho',
            q4: 'desempleado',
            q5: 'no',
            q6: 'si',
            q7: 'deficiente',
            q8: 'secundaria',
            q9: 'capacitacion',
            q10: 'si'
        };

        function testDiagnosis() {
            // Simular el sistema de diagn√≥stico
            const diagnosticForm = {
                answers: testAnswers,
                
                generateDetailedAnalysis() {
                    const analysis = {
                        primaryIssue: 'vulnerabilidad econ√≥mica severa',
                        specificProblems: ['Falta de empleo o ingresos estables', 'Deficiente acceso a salud', 'Problemas ambientales'],
                        economicImpact: 'se presenta una situaci√≥n econ√≥mica cr√≠tica con desempleo y ingresos insuficientes para cubrir necesidades b√°sicas',
                        socialImpact: 'existe disposici√≥n para participar en procesos comunitarios, lo cual es una fortaleza para el desarrollo social',
                        educationalImpact: 'existe inter√©s en capacitaci√≥n, lo cual es positivo para el desarrollo personal',
                        healthImpact: 'se presenta un acceso deficiente a servicios de salud, lo cual es una vulnerabilidad cr√≠tica',
                        specificRecommendations: [
                            'Buscar programas de empleo y apoyo econ√≥mico inmediato',
                            'Acceder a programas de apoyo econ√≥mico y alimentario',
                            'Buscar atenci√≥n en centros de salud p√∫blicos y programas de salud comunitaria',
                            'Buscar programas de capacitaci√≥n t√©cnica y profesional'
                        ]
                    };
                    return analysis;
                },

                generateFallbackDiagnosis() {
                    const userName = 'Usuario de Prueba';
                    const analysis = this.generateDetailedAnalysis();
                    
                    let fallbackText = `Querido/a ${userName}, seg√∫n el an√°lisis detallado de tus respuestas, `;
                    
                    if (analysis.primaryIssue) {
                        fallbackText += `tu diagn√≥stico social indica ${analysis.primaryIssue}. `;
                    }
                    
                    if (analysis.specificProblems.length > 0) {
                        fallbackText += `Se identificaron las siguientes problem√°ticas principales: ${analysis.specificProblems.join(', ')}. `;
                    }
                    
                    if (analysis.economicImpact) {
                        fallbackText += `En el aspecto econ√≥mico, ${analysis.economicImpact}. `;
                    }
                    
                    if (analysis.socialImpact) {
                        fallbackText += `En el aspecto social, ${analysis.socialImpact}. `;
                    }
                    
                    if (analysis.educationalImpact) {
                        fallbackText += `En el aspecto educativo, ${analysis.educationalImpact}. `;
                    }
                    
                    if (analysis.healthImpact) {
                        fallbackText += `En el aspecto de salud, ${analysis.healthImpact}. `;
                    }
                    
                    // Recomendaciones espec√≠ficas
                    if (analysis.specificRecommendations.length > 0) {
                        fallbackText += `\n\nRecomendaciones espec√≠ficas para tu situaci√≥n:\n`;
                        analysis.specificRecommendations.forEach((rec, index) => {
                            fallbackText += `${index + 1}. ${rec}\n`;
                        });
                    }
                    
                    // Mensaje de apoyo
                    fallbackText += `\n\nRecuerda que cada paso que tomes hacia la mejora de tu situaci√≥n es valioso. Te recomendamos buscar apoyo en programas locales de desarrollo social y consultar con un especialista en trabajo social para obtener un an√°lisis m√°s detallado.`;
                    
                    return fallbackText;
                }
            };

            const diagnosis = diagnosticForm.generateFallbackDiagnosis();
            
            document.getElementById('testResult').style.display = 'block';
            document.getElementById('testContent').innerHTML = `
                <h4>‚úÖ Diagn√≥stico Generado:</h4>
                <div style="background: white; padding: 15px; border-radius: 5px; margin: 10px 0; white-space: pre-line; line-height: 1.6;">${diagnosis}</div>
                <p><strong>Longitud del texto:</strong> ${diagnosis.length} caracteres</p>
                <p><strong>Estado:</strong> ${diagnosis.length > 100 ? '‚úÖ Texto completo' : '‚ùå Texto cortado'}</p>
            `;
        }

        function testChart() {
            // Esperar un poco para que Chart.js se cargue
            setTimeout(() => {
                document.getElementById('testResult').style.display = 'block';
                document.getElementById('testContent').innerHTML = `
                    <h4>üìä Test de Gr√°fica:</h4>
                    <p><strong>Chart.js disponible:</strong> ${typeof Chart !== 'undefined' ? '‚úÖ S√≠' : '‚ùå No'}</p>
                    <p><strong>Canvas disponible:</strong> ${document.getElementById('categoriesChart') ? '‚úÖ S√≠' : '‚ùå No'}</p>
                    <p><strong>Estado:</strong> ${typeof Chart !== 'undefined' ? '‚úÖ Gr√°fica lista' : '‚ùå Chart.js no cargado'}</p>
                    ${typeof Chart !== 'undefined' ? '<p style="color: green;">üéâ ¬°Chart.js est√° funcionando correctamente!</p>' : '<p style="color: red;">‚ö†Ô∏è Chart.js no se pudo cargar. Recarga la p√°gina.</p>'}
                `;
            }, 1000);
        }

        function clearResults() {
            localStorage.removeItem('diagnosticResults');
            document.getElementById('testResult').style.display = 'none';
            alert('Resultados limpiados');
        }
    </script>
</body>
</html>
